---
import BaseLayout from '../../../layouts/BaseLayout.astro';
import Hero from '../../../components/Hero.astro';
import Icon from '../../../components/Icon.astro';
import ContactCTA from '../../../components/ContactCTA.astro';
import { musicVideos } from '../../../data/musicVideos';

// 動的ルート用：全てのslugを生成
export function getStaticPaths() {
	return musicVideos.map((mv) => ({
		params: { slug: mv.slug },
		props: { mv },
	}));
}

const { mv } = Astro.props;

const title = `${mv.title} | ミュージックビデオ | 大鹿ニク / M1RA`;
const description = `${mv.intro} - 生成AIで制作したミュージックビデオ作品。`;
---

<BaseLayout title={title} description={description}>
	<!-- Breadcrumb Schema -->
	<script type="application/ld+json" slot="head">
	{
		"@context": "https://schema.org",
		"@type": "BreadcrumbList",
		"itemListElement": [
			{
				"@type": "ListItem",
				"position": 1,
				"name": "Home",
				"item": "https://niku.studio/"
			},
			{
				"@type": "ListItem",
				"position": 2,
				"name": "Work",
				"item": "https://niku.studio/work/"
			},
			{
				"@type": "ListItem",
				"position": 3,
				"name": "ミュージックビデオ",
				"item": "https://niku.studio/work/music-videos/"
			},
			{
				"@type": "ListItem",
				"position": 4,
				"name": mv.title,
				"item": `https://niku.studio/work/music-videos/${mv.slug}/`
			}
		]
	}
	</script>

	<!-- VideoObject Schema -->
	<script type="application/ld+json" slot="head">
	{
		"@context": "https://schema.org",
		"@type": "VideoObject",
		"name": mv.title,
		"description": mv.intro,
		"uploadDate": mv.releaseDate || "2024-01-01",
		"thumbnailUrl": `https://img.youtube.com/vi/${mv.youtubeId}/maxresdefault.jpg`,
		"embedUrl": `https://www.youtube.com/embed/${mv.youtubeId}`,
		"contentUrl": `https://www.youtube.com/watch?v=${mv.youtubeId}`,
		"creator": {
			"@type": "Person",
			"name": "大鹿ニク",
			"alternateName": "M1RA"
		}
	}
	</script>

	<div class="stack gap-20">
		<main class="wrapper stack gap-8">
			<Hero
				title={mv.title}
				tagline={mv.intro}
				align="start"
			>
				{mv.isNew && <span class="new-badge">NEW</span>}
			</Hero>

			<section class="mv-detail">
				<!-- YouTube埋め込み -->
				<div class="video-container">
					<iframe
						width="100%"
						height="100%"
						src={`https://www.youtube.com/embed/${mv.youtubeId}`}
						title={mv.title}
						frameborder="0"
						allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
						allowfullscreen
						loading="lazy"
					></iframe>
				</div>

				<!-- 作品情報 -->
				<div class="mv-info-section">
					<h2>作品について</h2>
					<p class="intro-text">{mv.intro}</p>

					<!-- 制作秘話へのリンク -->
					<div class="action-buttons">
						<a href={mv.noteUrl} target="_blank" rel="noopener noreferrer" class="note-link">
							<Icon icon="pencil-line" size="1.5em" />
							<span>制作秘話を読む</span>
							<Icon icon="external-link" size="1.2em" />
						</a>
					</div>
				</div>

				<!-- ナビゲーション -->
				<div class="navigation">
					<a href="/work/music-videos/" class="back-link">
						<Icon icon="arrow-left" size="1.2em" />
						<span>ミュージックビデオ一覧に戻る</span>
					</a>
				</div>
			</section>
		</main>
		<ContactCTA />
	</div>
</BaseLayout>

<style>
	.new-badge {
		display: inline-block;
		margin-top: 1rem;
		background: linear-gradient(135deg, #ff0080, #ff8c00);
		color: #ffffff;
		padding: 0.5rem 1rem;
		border-radius: 0.5rem;
		font-weight: 700;
		font-size: var(--text-sm);
		letter-spacing: 0.1em;
		box-shadow: 0 4px 12px rgba(255, 0, 128, 0.5);
		animation: pulse 2s ease-in-out infinite;
	}

	@keyframes pulse {
		0%, 100% {
			transform: scale(1);
			box-shadow: 0 4px 12px rgba(255, 0, 128, 0.5);
		}
		50% {
			transform: scale(1.05);
			box-shadow: 0 6px 20px rgba(255, 0, 128, 0.7);
		}
	}

	.mv-detail {
		display: flex;
		flex-direction: column;
		gap: 3rem;
	}

	.video-container {
		position: relative;
		width: 100%;
		padding-bottom: 56.25%; /* 16:9 aspect ratio */
		height: 0;
		overflow: hidden;
		border-radius: 1rem;
		background: rgba(0, 20, 40, 0.6);
		border: 2px solid rgba(0, 255, 136, 0.3);
		box-shadow: 0 0 30px rgba(0, 255, 136, 0.2);
	}

	.video-container iframe {
		position: absolute;
		top: 0;
		left: 0;
		width: 100%;
		height: 100%;
	}

	.mv-info-section {
		background: rgba(0, 20, 40, 0.6);
		border: 2px solid rgba(0, 255, 136, 0.3);
		border-radius: 1rem;
		padding: 2rem;
		text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.8);
	}

	.mv-info-section h2 {
		font-size: var(--text-2xl);
		color: #00ff88;
		margin-bottom: 1rem;
		font-weight: 700;
	}

	.intro-text {
		font-size: var(--text-lg);
		color: rgba(255, 255, 255, 0.95);
		line-height: 1.8;
		margin-bottom: 2rem;
	}

	.action-buttons {
		display: flex;
		flex-wrap: wrap;
		gap: 1rem;
	}

	.note-link {
		display: inline-flex;
		align-items: center;
		gap: 0.75rem;
		padding: 1rem 2rem;
		background: var(--gradient-accent);
		color: var(--gray-999);
		text-decoration: none;
		border-radius: 999rem;
		font-weight: 600;
		font-size: var(--text-md);
		transition: all 0.3s ease;
		box-shadow: var(--shadow-md);
	}

	.note-link:hover {
		transform: translateY(-2px);
		box-shadow: var(--shadow-lg);
	}

	.navigation {
		margin-top: 2rem;
	}

	.back-link {
		display: inline-flex;
		align-items: center;
		gap: 0.75rem;
		padding: 0.75rem 1.5rem;
		background: rgba(0, 255, 136, 0.1);
		border: 2px solid rgba(0, 255, 136, 0.3);
		border-radius: 0.5rem;
		color: #00ff88;
		text-decoration: none;
		font-weight: 600;
		font-size: var(--text-base);
		transition: all 0.3s ease;
	}

	.back-link:hover {
		background: rgba(0, 255, 136, 0.2);
		border-color: #00ff88;
		transform: translateX(-5px);
	}

	@media (max-width: 768px) {
		.mv-info-section {
			padding: 1.5rem;
		}

		.intro-text {
			font-size: var(--text-base);
		}

		.action-buttons {
			flex-direction: column;
		}

		.note-link, .back-link {
			width: 100%;
			justify-content: center;
		}
	}
</style>
